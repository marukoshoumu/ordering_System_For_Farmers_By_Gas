# README

## 農家用受注管理システム

本システムは、農家向けの受注管理を効率化するために設計されたGoogle App Script（GAS）と連携したテンプレートです。スプレッドシートをDB、GASファイルをバックエンド、HTMLをフロントエンドとして扱い、WEBアプリを実現しています。

以下では、各画面の機能、各シートの役割を説明します。

---

### 画面一覧

#### ログイン画面
- **紐づくシート**: pass
- **主な機能**
  - 画面から入力したIDとPassをもとにシート「pass」と比較し、正しい場合ホーム画面に遷移します。

#### ホーム画面
- **紐づくシート**: 受注
- **主な機能**:
  - **表示機能**: 
    - シート「受注」から最大5日分（昨日、今日、明日、明後日、明々後日）の発注日に紐づくデータを抽出し、以下の情報を表示します。
      - 納品方法ごとの件数
      - 対象の顧客名、商品名、個数
  - **遷移機能**:
    - 各画面への遷移ボタン
      | ボタン名    | 遷移先          |
      | ----------- | --------------- |
      | 受注管理    | 受注管理画面    |
      | 送り状作成  | 発送伝票画面    |
      | 請求書作成  | 請求書作成画面  |
      | 受注CSV取込 | 受注CSV取込画面 |
      | 見積書作成  | 見積書作成画面  |
    - データ参照ボタン
      | ボタン名         | 遷移先                             |
      | ---------------- | ---------------------------------- |
      | 見積書参照       | 見積書フォルダが開く               |
      | 商品情報参照     | スプレッドシート「商品」が開く     |
      | 顧客情報参照     | スプレッドシート「顧客情報」が開く |
      | 請求書参照       | 請求書フォルダが開く               |
      | 納品書参照       | 納品書フォルダが開く               |
      | 送り状ヤマト参照 | 発送伝票のヤマトフォルダが開く     |
      | 送り状佐川参照   | 発送伝票の佐川フォルダが開く       |
      | 受注一覧         | スプレッドシート「受注」が開く     |

#### 受注管理画面
- **紐づくシート**: クール区分、ヤマトCSV、佐川CSV、受付方法、受注、商品、商品分類、担当者、発送先情報、納品方法、荷扱い、送り状種別、配送時間帯、顧客情報
- **主な機能**:
  - 各マスタデータをスプレッドシートから取得し、シート「受注」に顧客情報、発送情報、発送元情報、商品情報などを登録。
  - 納品書や領収書のチェックを入れて登録すると、対象データをもとにPDFを指定のフォルダに作成。
  - 納品方法がヤマトまたは佐川の場合、発送伝票フォーマットに従ったCSVデータを登録。
  - 顧客情報の新規登録や検索機能を提供。
  - 顧客情報から前回受注内容や見積書情報を反映可能。
  - 発送先情報の新規登録や検索機能を提供。
  - 発送元情報はシート「会社名」を参照可能。

#### 発送伝票画面
- **紐づくシート**: ヤマトCSV、佐川CSV
- **主な機能**:
  - シート「ヤマトCSV」「佐川CSV」から指定された発送日に紐づくデータを抽出し、発送伝票フォルダにCSVファイルを生成。

#### 請求書作成画面
- **紐づくシート**: 受注
- **主な機能**:
  - 指定期間に紐づく受注データを抽出し、請求書フォルダに顧客ごとのPDF請求書を生成。
  - 注意: 
    - 顧客名を指定した場合：指定された顧客のデータのみ抽出。
    - 顧客名を指定しない場合：期間内の全顧客データを抽出。

#### 受注CSV取込画面
- **紐づくシート**: 受注、食べチョク商品、ポケマル商品、ふるさと納税商品
- **主な機能**:
  - 各プラットフォーム（食べチョク、ポケマル、ふるさと納税）のCSVファイルをシート「受注」に取り込み可能。
  - 商品名や数量を変換して対応。

#### 見積書作成画面
- **紐づくシート**: 保存温度帯、単位、商品、商品分類、見積書、見積書データ、見積納品方法
- **主な機能**:
  - 見積書のデータ登録とPDF生成。
  - 登録データは受注管理画面で利用可能。

---

### シートごとの概要と機能

#### 1. 商品
- **目的**: 商品情報の登録、編集、管理。
- **データ項目**: 商品分類、商品名、価格、原価、在庫数、税率。
- **主な機能**:
  - 新しい商品を登録。
  - 商品の原価や粗利を自動計算。
  - 受注管理画面の商品情報となる。

#### 2. 受注
- **目的**: 受注データを一元管理。
- **データ項目**: 受注ID、受注日、商品名、受注数、顧客情報、納品方法、発送先情報。
- **主な機能**:
  - 受注の新規登録および編集。
  - 発送情報を基にCSVファイルを生成。
  - ホーム画面の発送件数情報、作業指示書として活用。

#### 3. ヤマトCSV / 佐川CSV
- **目的**: 配送業者向けの送り状データを自動生成。
- **データ項目**: 配送日、送り状種別、品名、クール区分、配送先住所、連絡先。
- **主な機能**:
  - ヤマト運輸または佐川急便向けのCSVデータ。

#### 4. 顧客情報
- **目的**: 顧客情報を管理。
- **データ項目**: 顧客名、住所、電話番号、メールアドレス、備考。
- **主な機能**:
  - 顧客の新規登録と編集。
  - 顧客リストからの検索機能。

#### 5. 利益管理表
- **目的**: 月ごとの利益を視覚的に確認。
- **データ項目**: 商品名、月別利益額。
- **主な機能**:
  - 受注データをもとに売上データから利益を自動集計。
  - グラフなどを使用した可視化。

#### 6. 発送先情報
- **目的**: 発送先情報を管理。
- **データ項目**: 会社名、部署、住所、連絡先、備考。
- **主な機能**:
  - 発送先の登録と更新。
  - 顧客情報と連動したデータ参照。

---

### 使用方法
1. **初期設定**: 必要なシートに基本データ（商品、顧客情報など）を入力してください。
2. **受注登録**: 受注シートにデータを入力して、新しい受注を記録します。
3. **CSV生成**: ヤマトCSVまたは佐川CSVシートを使用して配送データを生成します。
4. **利益確認**: 利益管理表シートで月別の利益を確認します。
5. **見積書作成**: 見積書シートに必要な情報を入力して見積書を作成します。

---

### サンプル画面
- [サンプル画面リンク]([https://script.google.com/macros/s/AKfycbyru-CLcwLDLf2DhXa1XjvgBPzjrIGw1sDaj7dCDS3V/dev](https://script.google.com/macros/s/AKfycbz0iqzBlnOSffijkMLhDuJz7d6B80R0Fa-mwxs4RqRB_JMSkWEhKur2fAdfjSVVQQvYuA/exec)
  - Google App Scriptによる画面例。実際の操作感を体験できます。

### テンプレート
- [スプレッドシートテンプレートリンク](https://docs.google.com/spreadsheets/d/1FpMhNnld3DgZ2IhpofV4YSqqT4Tk0oxUWuVQTcwIAbM/edit?usp=drive_link)
  - 本システムで使用するGoogleスプレッドシートのテンプレート。

